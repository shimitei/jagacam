# jagacam

ブラウザを通じてカメラの映像をやり取りします。  
特徴としては、低速回線向けや通信容量の制限を回避するためにリアルタイム性を追求しません。
1fpsの1秒1コマ程度でやり取りします。  
1対1以外（3クライアント以上）にも対応しています。

## 使い方

'https://www.example.com/room/room1' 等の /room/ルーム名 にアクセスします。  
ルーム毎のカメラ映像共有になります。共有する人たちと同じルームにアクセスしてください。

ページには以下が表示されます。

- 自分のカメラの映像
- カメラの切り替えセレクトボックス  
  Chromeのみ機能します。
- ループバックテストのチェックボックス  
  チェックを入れると、自分の送信映像を受信します。  
  チェックを入れている間はカメラ映像は共有されません。
- 共有するPDFファイル選択   
  ※共有可能なファイルは1つのみ。後に選択したもの勝ち。
- 共有されている映像
- 共有されているPDF  
  ※表示ページの同期機能はありません

### オプション

'/room/room1?mt=webp&q=0.75' のようにカメラ映像のmimetype, qualityを指定することができます。

| Name |     | Value |
| ---- | --- | --- |
| mt   | 送信画像のMIMEタイプ指定 | png, jpeg, webp 等が有効です。<br>※wepbはChrome等のブラウザで有効です。 |
| q    | 送信画像の品質指定 | 0.0から1.0の値が有効です。<br>1.0に近いほど高品質・データサイズ大になります。 |

## 対応ブラウザ、条件

- PC内蔵カメラまたは外付けカメラが必要です。
- Google Chrome  
  httpsのページ、http://localhost のページのみカメラにアクセス可能です。
- Mozilla Firefox  
  カメラの選択はブラウザのカメラアクセス確認ダイアログ内で行います。
- Microsoft Edge  
  カメラの切り替えが出来ません？（フロントカメラ限定？）

## 技術情報

ブラウザのクライアント側は、Navigator.getUserMedia APIを利用してカメラ映像をキャプチャします。  
キャプチャした画像データ（JPEG + Base64エンコード）をWebSocketでサーバーと送受信します。

サーバー側は、Node.js（expressフレームワーク）で構築、WebSocketの処理はSocket.IOライブラリを使用しています。

## ToDo

- 送信前にBase64デコードしてデータ量を減らす。
